### 프로젝트 개요

---

- 프로젝트 요약
    - 서울시 공공자전거 따릉이는 계절별로 고장률이 변동하며, 특히 **8월과 9월 사이의 변화가 뚜렷**합니다.
    - 2023년과 2024년 데이터를 비교한 결과, **2023년 9월**: 고장률 급감 **2024년 9월**: 고장률 상승을 확인했습니다.
    - 본 프로젝트는 **9월 고장률 상승의 원인을 분석하고, 2025년 대비 정비 전략을 수립하는 것**을 목표로 합니다.

- 프로젝트 배경
    - 서울시 공공자전거 따릉이 이용건수가 매년 증가
    - 2023년 12만 건 돌파, 2024년 상반기만 10만 건 돌파
    - 따릉이는 서울 시민의 교통수단이자 여가수단으로 자리 잡음
    - 하지만, 빈번한 고장으로 시민들의 불편 증가 및 이용객 안전 위협

- 프로젝트 목표
    - 시설관리팀이 따릉이 정비를 효과적으로 수행할 수 있도록 데이터 기반 개선안 제공
    - 고장률이 높은 지역과 시간대를 파악하여 정비 전략을 수립
    - 2025년 8월 대비를 강화하여 9월 고장률 상승 억제
      
- 주요 분석 질문
    - 1️⃣ 2024년 9월에는 왜 고장률이 증가했는가?
    - 2️⃣ 기존 서울시 공공자전거 정비 시스템은 효율적인가?
    - 3️⃣ 2025년 8월에는 어떤 대비를 해야 9월 고장률 상승을 막을 수 있는가?
    - 4️⃣ 시설관리팀이 정비팀 운영을 최적화할 수 있도록 어떻게 데이터를 제공할 것인가?

---

### 데이터 분석 단계

---

- 1️⃣ 2023년, 2024년 월단위 고장률 분석 및 시각화
    - 활용 데이터
        - 서울시 공공자전거 고장신고 내역
        - 서울특별시 공공자전거 대여소별 이용정보(월별)
    - 데이터 출처
        - 서울시 열린데이터 광장
    - 데이터 전처리 과정
        1. 중복 제거 (자전거번호, 등록일시 기준으로 중복값 제거)
        2. 날짜 형식 변환 ( object 타입 → datetime 형식)
        3. 년도, 월 별로 그룹화 (고장건수, 대여건수 계산)
    - 사용 라이브러리: Pandas, NumPy
    - 분석 과정
        - 월별 고장률 계산
            
            고장률 공식: 고장률 = (월별 고장 신고 건수 / 월별 대여 건수) * 100
            
        - 월별 고장률 시각화
            - 라인 그래프: 2023년과 2024년의 월별 고장률 비교
            - 시각화 코드
            
            ```jsx
            # 라인 그래프 그리기
            plt.figure(figsize=(10, 5)
            
            # 색상 시정
            colors = {2023: 'orange', 2024: 'gold'}
            
            # 각 연도별 선 그래프 추가
            for year in yearly_monthly_fault_rate.columns:
                    plt.plot(yearly_monthly_fault_rate.index # 월,
                                                    yearly_monthly_fault_rate[year],
                                                    mark='o',
                                                    linestyle='-',
                                                    color=colors[year], # color 딕셔너리 key값을 가져옴
                                                    label=f'{year}년')
             # 그래프 꾸미기
             plt.xlabel('월')
             plt.ylabel('고장률(%)')
             plt.title('연도별 월별 고장률 비교 (2023 VS 2024)')
             plt.xticks(range(1, 13))
             plt.grid(True)
             plt.legend()
            
            # 그래프 출력
            plt.show()
            
            ```
            

- 2️⃣ 2024년 8월, 9월 자치구별 고장률 분석 및 지도 시각화
    - 분석 단계
        1. 각 자치구 별 8월 총 대여건수 파악
        2. 각 자치구 별 8월 고장신고건수 파악
            1. 고장신고 전 마지막 반납대여소번호 확인
            2. 마지막 반납 대여소를 기준으로 자치구 찾기
        3. 8월 각 자치구 대여건수 대비 고장신고율 구하기
        4. 8월 고장률을 이용하여 자치구 등급 나누기
        5. 8월 자치구 고장률을 지도로 시각화
    - 활용 데이터
        - 서울특별시 공공자전거 대여이력 정보
        - 서울시 공공자전거 대여소 정보
        - 서울시 공공자전거 고장신고 내역
        - seoul_municipalities_geo.json
    - 데이터 출처
        - 서울 열린데이터 광장
        - southkorea/seoul-maps github
    - 데이터 전처리 과정
        - 각 자치구 별 8월 총 대여건수 파악
            - 데이터 전처리
                1. 불필요한 컬럼 제거(상세주소, 위도, 경도, 설치시기 등)
                2. 이스케이프 문자열 처리
                    1. 반납대여소번호, 대여대여소번호 '\N' 데이터 NaN으로 대체
                    2. 반납대여소번호 NaN값 대여 대여소번호로 대체
                3. 결측치 제거 (반납대여소번호 NaN값인 927개 데이터 제거)
                4. 대여이력 데이터, 대여소 정보 데이터 병합 (반납대여소번호 기준)
            - 분석 과정
                - 자치구별 대여건수 합산
                
                ```jsx
                total_county = rental_merged['자치구'].value_counts().reset_index()
                total_county.columns = ['자치구', '총대여수']
                
                ```
                
        - 각 자치구 별 8월 고장신고건수 파악
            - 데이터 전처리
                1. 날짜 형식 변환 ( object 타입 → datetime 형식)
                2. 중복 제거(등록일시, 자전거번호 기준)
                3. 데이터 병합(8월 자치구별 대여이력 + 고장신고, 자전거번호 기준)
            - 분석과정
                - 1차 필터링
                    
                    ```jsx
                    # 고장 등록일시 > 반납시간 -> 1차 필터링
                    last_retunred['등록일시'] > last_returned['반납일시']
                    
                    ```
                    
                - 2차 필터링
                    
                    ```jsx
                    # 등록일시 - 반납일시 -> 시간차 구하기
                    last_returned['시간차'] = (last_returned['등록일시] - last_returned['반납일시']).dt.total_seconds()
                    last_returned.sort_values(by=['자전거번호', '등록일시', '시간차'], ascending=[True, True, True])
                    
                    # 시간차가 가장 작은 데이터만 남기고 제거 -> 고장신고 전 마지막 반납기록
                    last_returned.drop_duplicates(subset=['자전거번호', '등록일시'], keep='first')
                    
                    ```
                    
        - 8월 각 자치구 대여건수 대비 고장신고율 구하기
            - 데이터 전처리
                - 데이터 병합 (8월 각 자치구 총 고장신고 건수 + 8월 각 자치구 총 대여건수, ‘자치구’ 기준)
            - 분석과정
                - 고장률 = (고장신고건수 / 총대여수) * 100
        - 8월 고장률을 이용하여 자치구 등급 나누기
            - 분석과정
                - 고장률 순위 부여 (고장률 낮은 순서 → 높은 순서)
                    
                    ```jsx
                    rank['랭킹'] = rank['고장률'].rank(method='dense', ascending=True).astype(int)
                    
                    ```
                    
                - 고장률 순위에 따른 등급 부여
                    
                    ```jsx
                    # 등급 리스트
                    grade_labels =  [""따릉이 레전드 🏆"", ""따릉이 매너왕 👑"", ""따릉이 우등생 🎯"", ""따릉이 주의보 📉"", ""따릉이 응급실 🚨""]
                    
                    # 랭킹을 기반으로 등급 배정
                    ranking['등급'] = pd.cut(ranking['랭킹'], bins=[0, 3, 9, 16, 22, 25], labels= grade_labels, includ_lowest=True)
                    
                    ```
                    
        - 8월 자치구 고장률을 지도로 시각화
    - 사용라이브러리: pandas, numpy, folium, json

-  4️⃣ 2024년 8월 총 대여이력에 고장신고 여부 추가 후 고장부품 분석
    - 활용 데이터
        - 8월 대여이력 전처리 후
        - 8월 고장신고 전 마지막 사용 기록
        - 공공자전거 대여소 정보
    - 데이터 출처
        - 서울 열린데이터 광장
    - 데이터 전처리 과정
        1. 날짜 형식 변환 ( object 타입 → datetime 형식)
        2. 필요없는 컬럼 제거(대여소번호, 대여 대여소명 등)
    - 분석 과정
        - 고장여부 표시
        
        ```jsx
        # 고장여부 컬럼 생성
        rental['고장여부'] = 0
        
        # 전체 대여이력 데이터 자전거 번호, 마지막 사용기록 데이터 자전거 번호 비교
        # 고장여부 = 1 로 설정
        rental.loc[
                rental.set_index(['자전거번호', '반납일시']).index.isin(broke_df.set_index(['자전거번호', '반납일시'].index)
                , '고장여부'
        ] = 1
        
        ```
        
        - 자치구 추가하기
        
        ```jsx
        rental_merged = rental.merge(station_info[['대여소번호', '자치구']], left_on='반납대여소번호', right_on='대여소번호', how='left')
        
        ```
        
    - 사용 라이브러리: Pandas, NumPy

---

### 데이터 분석 결과

---

- 1️⃣ 8월 고장률과 9월 고장률의 관계
    - **가설:** 8월의 고장률이 높으면 9월의 고장률이 낮아질 것이다.
    - **분석 결과:**
        - **8월 정비와 9월 고장률의 상관관계 분석 결과, 강한 양의 상관관계를 가짐**
        - **즉, 8월 고장률이 높았던 지역의 9월 고장률도 높은 패턴이 나타남**
    - **결론:** 기존 정비가 제대로 이루어지지 않았을 가능성이 있음. 기후 요인 등 추가적인 요소 분석 필요.

- 2️⃣ 기온이 따릉이 고장률에 미치는 영향
    - **가설:** 기온이 높을수록 자전거 고장률이 높을 것이다.
    - **분석 결과:**
        - **타이어, 체인 등 주요 부품의 고장률이 기온 상승과 함께 증가하는 경향 확인**
        - **2024년 9월 서울의 평균기온은 2023년 대비 상승**
        - **역대 최고 기온, 최다 폭염일수, 최다 열대야 기록**
    - **결론:** 기온 상승이 2024년 9월 고장률 증가의 주요 원인 중 하나로 작용했을 가능성이 큼.

---

### 기존 정비 시스템의 문제점

---

- 1️⃣ 기존 정비 방식
    - 서울시는 2024년 따릉이포 도입을 통해 증가하는 고장률을 개선하고자 함.
        - **따릉이포:** 81개 점포 운영 (강남권 42개, 강북권 39개)
        - **효과:** 2023년 대비 월별 고장률 감소
        - **한계:** 2024년 9월 고장률 개선 실패
    
- 2️⃣ 기존 사후 정비 시스템의 한계
    - 현재 방식: **이용객 고장 신고 → 공단에서 자전거 회수 → 따릉이포 정비 요청 → 정비 완료 후 재배치**
    - 문제점: 고장이 발생한 후 여러 단계를 거쳐야 수리가 이루어지며, **여름철 증가하는 고장률을 감당하기 어려움**

---

### 2025년 8월 대비 전략

---

- 해결책 ① : 탄력적 사전 정비팀 도입
    - **따릉이포 사전 정비팀:** 기존의 공단을 거치지 않고, 따릉이포 점포에서 직접 **문제 발생 가능성이 높은 지역을 순찰하며 사전 점검**
    
    🔹 사전 정비 전략 1: 고장률이 높은 자치구 우선 정비
    
    - 2024년 8월 자치구별 고장률을 기준으로 **상대적 등급 부여**
    - **따릉이 응급실 (고장률 상위 3개 자치구) → 서초구, 강남구, 금천구**
    - 2025년 8월, 해당 지역에 **따릉이포 사전 정비팀 배치**
    
    🔹 사전 정비 전략 2: 고장률이 높은 부품 우선 점검
    
    - **2024년 8월 고장 신고 최다 부품:**
        1. 타이어 (3,487건)
        2. 체인 (3,240건)
        3. 기타 (브레이크, 경종 등) (2,637건)
    - **따릉이포 사전 점검팀이 정거장을 순찰하며 해당 부품 우선 점검**
    
    🔹 사전 정비 전략 3: 시간대별 정비 최적화
    
    - **2024년 8월 고장 신고 분석 결과, 18:00~21:00 퇴근 시간대에 신고 최다**
    - **따릉이포 정비팀 시간대별 운영 전략**
        - **오전 (05:00 - 10:00):** 사전 순찰 및 경미한 수리 (타이어 공기압, 체인 점검)
        - **오후 (12:00 - 18:00):** 집중 정비 및 주요 부품 교체
        - **저녁 (18:00 - 21:00):** 긴급 출동팀 운영
        
    - 해결책 ② : 따릉이 고장 관리 대시보드 제공
        - 시설관리팀이 즉각적인 의사 결정을 내릴 수 있도록 대시보드 구축
        - 대시보드 주요 기능
            - 이달 총 대여 대비 고장률
            - **고장률이 가장 낮은 자치구 & 가장 높은 자치구**
            - **각 자치구별 따릉이 등급 (레전드/매너왕/우등생/주의보/응급실)**
            - **고장률 TOP 3 자치구의 고장 원인 분석**
            - **고장률 TOP 3 시간대별 고장 신고량 분석**

---

### 기대 효과

- 정비팀이 자원 배분을 최적화할 수 있도록 데이터 제공
- 각 지역의 고장률을 효과적으로 관리하여 운영 효율성 향상
- 시설관리팀이 ‘어디를 먼저 정비할 것인가?’에 대한 근거 있는 판단 가능

---

### 최종 결론

- 8월 대비 부족이 9월 고장률 증가의 원인 → 2025년 8월 철저한 정비 필요
- 정비팀 운영 최적화와 시설관리팀의 유지보수 전략 개선 가능
- 태블로 대시보드를 활용하여 데이터 기반 정비 계획 수립 가능
